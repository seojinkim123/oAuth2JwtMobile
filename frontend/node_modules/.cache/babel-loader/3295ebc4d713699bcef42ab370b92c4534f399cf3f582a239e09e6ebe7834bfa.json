{"ast":null,"code":"import axios from 'axios';\nimport { TokenStorage } from '../utils/tokenStorage';\n\n// ðŸ”’ Axios ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ì¿ í‚¤ ê¸°ë°˜)\nconst api = axios.create({\n  baseURL: 'http://localhost:8080/api',\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  withCredentials: true // ðŸ”’ ì¿ í‚¤ í¬í•¨í•˜ì—¬ ìš”ì²­\n});\n\n// ðŸ”’ ìš”ì²­ ì¸í„°ì…‰í„° - HTTP-Only ì¿ í‚¤ ê¸°ë°˜ì´ë¯€ë¡œ í† í° í—¤ë” ì„¤ì • ë¶ˆí•„ìš”\napi.interceptors.request.use(config => {\n  // HTTP-Only ì¿ í‚¤ëŠ” ë¸Œë¼ìš°ì €ê°€ ìžë™ìœ¼ë¡œ í¬í•¨í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// ðŸ”’ ì‘ë‹µ ì¸í„°ì…‰í„° - 401 ì˜¤ë¥˜ ì‹œ ë¡œê·¸ì¸ íŽ˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸\napi.interceptors.response.use(response => {\n  return response;\n}, async error => {\n  var _error$response;\n  // 401 Unauthorized ì˜¤ë¥˜ ì‹œ ìžë™ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    console.log('ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ íŽ˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');\n\n    // ì¿ í‚¤ ê¸°ë°˜ì´ë¯€ë¡œ ì„œë²„ì—ì„œ í† í° ì‚­ì œ ì‹œë„\n    try {\n      await TokenStorage.clearTokens();\n    } catch (logoutError) {\n      console.error('ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', logoutError);\n    }\n\n    // ë©”ì¸ íŽ˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë¡œê·¸ì¸ ìƒíƒœ ì´ˆê¸°í™”)\n    window.location.href = '/';\n  }\n  return Promise.reject(error);\n});\n\n// API í•¨ìˆ˜ë“¤\nexport const ApiService = {\n  // ê³µê°œ API\n  hello: () => api.get('/hello'),\n  // ì¸ì¦ì´ í•„ìš”í•œ API\n  getCurrentUser: () => api.get('/me'),\n  getUser: id => api.get(`/user/${id}`),\n  // í† í° ê´€ë ¨ API\n  refreshToken: refreshToken => axios.post('http://localhost:8080/api/auth/refresh', {\n    refreshToken\n  }),\n  validateToken: token => axios.post('http://localhost:8080/api/auth/validate', {\n    token\n  })\n};\nexport default api;","map":{"version":3,"names":["axios","TokenStorage","api","create","baseURL","headers","withCredentials","interceptors","request","use","config","error","Promise","reject","response","_error$response","status","console","log","clearTokens","logoutError","window","location","href","ApiService","hello","get","getCurrentUser","getUser","id","refreshToken","post","validateToken","token"],"sources":["/Users/kimseojin/Desktop/oAuth2Jwt/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\nimport { TokenStorage } from '../utils/tokenStorage';\n\n// ðŸ”’ Axios ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ì¿ í‚¤ ê¸°ë°˜)\nconst api = axios.create({\n  baseURL: 'http://localhost:8080/api',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  withCredentials: true, // ðŸ”’ ì¿ í‚¤ í¬í•¨í•˜ì—¬ ìš”ì²­\n});\n\n// ðŸ”’ ìš”ì²­ ì¸í„°ì…‰í„° - HTTP-Only ì¿ í‚¤ ê¸°ë°˜ì´ë¯€ë¡œ í† í° í—¤ë” ì„¤ì • ë¶ˆí•„ìš”\napi.interceptors.request.use(\n  (config) => {\n    // HTTP-Only ì¿ í‚¤ëŠ” ë¸Œë¼ìš°ì €ê°€ ìžë™ìœ¼ë¡œ í¬í•¨í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// ðŸ”’ ì‘ë‹µ ì¸í„°ì…‰í„° - 401 ì˜¤ë¥˜ ì‹œ ë¡œê·¸ì¸ íŽ˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸\napi.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  async (error) => {\n    // 401 Unauthorized ì˜¤ë¥˜ ì‹œ ìžë™ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬\n    if (error.response?.status === 401) {\n      console.log('ì¸ì¦ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ íŽ˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');\n      \n      // ì¿ í‚¤ ê¸°ë°˜ì´ë¯€ë¡œ ì„œë²„ì—ì„œ í† í° ì‚­ì œ ì‹œë„\n      try {\n        await TokenStorage.clearTokens();\n      } catch (logoutError) {\n        console.error('ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', logoutError);\n      }\n      \n      // ë©”ì¸ íŽ˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë¡œê·¸ì¸ ìƒíƒœ ì´ˆê¸°í™”)\n      window.location.href = '/';\n    }\n\n    return Promise.reject(error);\n  }\n);\n\n// API í•¨ìˆ˜ë“¤\nexport const ApiService = {\n  // ê³µê°œ API\n  hello: () => api.get('/hello'),\n\n  // ì¸ì¦ì´ í•„ìš”í•œ API\n  getCurrentUser: () => api.get('/me'),\n  getUser: (id) => api.get(`/user/${id}`),\n\n  // í† í° ê´€ë ¨ API\n  refreshToken: (refreshToken) => \n    axios.post('http://localhost:8080/api/auth/refresh', { refreshToken }),\n  \n  validateToken: (token) => \n    axios.post('http://localhost:8080/api/auth/validate', { token }),\n};\n\nexport default api;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,uBAAuB;;AAEpD;AACA,MAAMC,GAAG,GAAGF,KAAK,CAACG,MAAM,CAAC;EACvBC,OAAO,EAAE,2BAA2B;EACpCC,OAAO,EAAE;IACP,cAAc,EAAE;EAClB,CAAC;EACDC,eAAe,EAAE,IAAI,CAAE;AACzB,CAAC,CAAC;;AAEF;AACAJ,GAAG,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CACzBC,MAAM,IAAK;EACV;EACA,OAAOA,MAAM;AACf,CAAC,EACAC,KAAK,IAAK;EACT,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAT,GAAG,CAACK,YAAY,CAACO,QAAQ,CAACL,GAAG,CAC1BK,QAAQ,IAAK;EACZ,OAAOA,QAAQ;AACjB,CAAC,EACD,MAAOH,KAAK,IAAK;EAAA,IAAAI,eAAA;EACf;EACA,IAAI,EAAAA,eAAA,GAAAJ,KAAK,CAACG,QAAQ,cAAAC,eAAA,uBAAdA,eAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;IAClCC,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;;IAE3C;IACA,IAAI;MACF,MAAMjB,YAAY,CAACkB,WAAW,CAAC,CAAC;IAClC,CAAC,CAAC,OAAOC,WAAW,EAAE;MACpBH,OAAO,CAACN,KAAK,CAAC,eAAe,EAAES,WAAW,CAAC;IAC7C;;IAEA;IACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,GAAG;EAC5B;EAEA,OAAOX,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACA,OAAO,MAAMa,UAAU,GAAG;EACxB;EACAC,KAAK,EAAEA,CAAA,KAAMvB,GAAG,CAACwB,GAAG,CAAC,QAAQ,CAAC;EAE9B;EACAC,cAAc,EAAEA,CAAA,KAAMzB,GAAG,CAACwB,GAAG,CAAC,KAAK,CAAC;EACpCE,OAAO,EAAGC,EAAE,IAAK3B,GAAG,CAACwB,GAAG,CAAC,SAASG,EAAE,EAAE,CAAC;EAEvC;EACAC,YAAY,EAAGA,YAAY,IACzB9B,KAAK,CAAC+B,IAAI,CAAC,wCAAwC,EAAE;IAAED;EAAa,CAAC,CAAC;EAExEE,aAAa,EAAGC,KAAK,IACnBjC,KAAK,CAAC+B,IAAI,CAAC,yCAAyC,EAAE;IAAEE;EAAM,CAAC;AACnE,CAAC;AAED,eAAe/B,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}